{% extends 'base.html.twig' %}

{% block title %}Mon calendrier{% endblock %}

{% block body %}
<div class="container py-5">
    <h3>Mes rendez-vous programmés</h3>

    <div class="list-group mt-4">
        {% for a in appointments %}
            <div class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    <strong>{{ a.startAt|date('d/m/Y H:i') }}</strong> - {{ a.patient.fullName }}
                </div>
                <div class="d-flex align-items-center gap-2">
                    {% if a.status == 'confirmed' %}
                        <span class="badge rounded-pill bg-info text-dark px-3 py-2">
                            <i class="fas fa-clock me-1"></i>Confirmé
                        </span>
                    {% elseif a.status == 'done' %}
                        <span class="badge rounded-pill bg-success px-3 py-2">
                            <i class="fas fa-check-circle me-1"></i>Terminé
                        </span>
                    {% elseif a.status == 'canceled' %}
                        <span class="badge rounded-pill bg-danger px-3 py-2">
                            <i class="fas fa-times-circle me-1"></i>Annulé
                        </span>
                    {% else %}
                        <span class="badge rounded-pill bg-warning text-dark px-3 py-2">
                            <i class="fas fa-hourglass-half me-1"></i>En attente
                        </span>
                    {% endif %}
                    {% if a.status != 'done' %}
                        <form method="post" action="{{ path('doctor_update_status', {'id': a.id}) }}" style="display:inline;">
                            <input type="hidden" name="status" value="done">
                            <button type="submit" class="btn btn-outline-success btn-sm rounded-pill px-3 ms-2" title="Marquer comme terminé">
                                <i class="fas fa-check me-1"></i>Terminer
                            </button>
                        </form>
                    {% endif %}
                    {% if a.status != 'canceled' %}
                        <form method="post" action="{{ path('doctor_update_status', {'id': a.id}) }}" style="display:inline;">
                            <input type="hidden" name="status" value="canceled">
                            <button type="submit" class="btn btn-outline-danger btn-sm rounded-pill px-3 ms-2" title="Annuler" onclick="return confirm('Êtes-vous sûr de vouloir annuler ce rendez-vous ?')">
                                <i class="fas fa-times me-1"></i>Annuler
                            </button>
                        </form>
                    {% endif %}
                </div>
            </div>
        {% else %}
            <div class="alert alert-info">Aucun rendez-vous planifié.</div>
        {% endfor %}
    </div>
    </div>
</div>
{% endblock %}
